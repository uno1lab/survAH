<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Vignette for survAH package • survAH</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Vignette for survAH package">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="inverse" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">survAH</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/vignette-survAH.html">Vignette for survAH package</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/uno1lab/survAH"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Vignette for survAH package</h1>
                        <h4 data-toc-skip class="author">Hajime Uno<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Dana-Farber Cancer Institute, &lt;a href="mailto:huno@ds.dfci.harvard.edu" class="email"&gt;huno@ds.dfci.harvard.edu&lt;/a&gt;&lt;/p&gt;'><sup>1</sup></a>, Miki
Horiguchi<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Dana-Farber Cancer Institute, &lt;a href="mailto:horiguchimiki@gmail.com" class="email"&gt;horiguchimiki@gmail.com&lt;/a&gt;&lt;/p&gt;'><sup>2</sup></a>
</h4>
            
            <h4 data-toc-skip class="date">January 16, 2023</h4>
      

      <div class="d-none name"><code>vignette-survAH.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">1 Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>An important objective of clinical research investigating the safety
and efficacy of a new intervention is to provide quantitative
information about the intervention effect on clinical outcomes. Such
quantitative information is critical for informed treatment decision
making to balance the risks and benefits of the new intervention. In
those studies where time-to-event outcomes are clinical endpoints of
interest, the traditional Cox’s hazard ratio (HR) has been used for
estimating and reporting the treatment effect magnitude for many
decades. However, this traditional approach may not have provided the
sufficient quantitative information that is needed for informed decision
making in clinical practice for the following reasons. First, this
approach does not require calculating the absolute hazard in each group
in order to calculate the HR, which is a desirable feature from a
statistical point of view, but which makes the clinical interpretation
difficult. From the clinical point of view, the two numbers from the
treatment and control groups are necessary for interpreting a
between-group contrast measure (e.g., difference or ratio). Second, if
the proportional hazards assumption is not correct, the interpretation
of HR is not obvious because it is affected by the underlying
study-specific censoring time distribution.[1,2]</p>
<p>The average hazard with survival weight (AHSW), which can be
interpreted as the general censoring-free incidence rate (CFIR), is a
summary measure of the event time distribution and does not depend on
the underlying study-specific censoring time distribution. The approach
using AHSW (or CFIR) provides two numbers from the treatment and control
groups and allows us to summarize the treatment effect magnitude in both
absolute and relative terms, which would enhance the clinical
interpretation of the treatment effect on time-to-event outcomes.[3]</p>
<p>This vignette is a supplemental documentation for the <em>survAH</em>
package and illustrates how to use the functions in the package to
compare two groups with respect to the AHSW (or CFIR). The package was
made and tested on R version 4.2.2.</p>
</div>
<div class="section level2">
<h2 id="installation">2 Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Open the R or RStudio applications. Then, copy and paste either of
the following scripts to the command line.</p>
<p>To install the package from the CRAN:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"survAH"</span><span class="op">)</span></span></code></pre></div>
<p>To install the development version:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span> <span class="co">#-- if the devtools package has not been installed</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"uno1lab/survAH"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="sample-reconstructed-data">2 Sample Reconstructed Data<a class="anchor" aria-label="anchor" href="#sample-reconstructed-data"></a>
</h2>
<p>Throughout this vignette, we use sample reconstructed data of the
CheckMate214 study reported by Motzer et al. [4] The data consists of
847 patients with previously untreated clear-cell advanced renal-cell
carcinoma; 425 for the nivolumab plus ipilimumab group (treatment) and
422 for the sunitinib group (control).</p>
<p>The sample reconstructed data of the CheckMate214 study is available
on <em>survAH</em> package as <em>cm214_pfs</em>. To load the data, copy
and paste the following scripts to the command line.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">survAH</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">cm214_pfs</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 847</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cm214_pfs</span><span class="op">)</span></span>
<span><span class="co">#&gt;    time status arm</span></span>
<span><span class="co">#&gt; 1 0.451      1   1</span></span>
<span><span class="co">#&gt; 2 0.451      1   1</span></span>
<span><span class="co">#&gt; 3 0.451      1   1</span></span>
<span><span class="co">#&gt; 4 0.451      1   1</span></span>
<span><span class="co">#&gt; 5 0.451      1   1</span></span>
<span><span class="co">#&gt; 6 0.710      1   1</span></span></code></pre></div>
<p>Here, <strong>time</strong> is months from the registration to
progression-free survival (PFS), <strong>status</strong> is the
indicator of the event (1: event, 0: censor), and <strong>arm</strong>
is the treatment assignment indicator (1: Treatment group, 0: Control
group).</p>
<p>Below are the Kaplan-Meier estimates for the PFS for each treatment
group.</p>
<p><img src="vignette-survAH_files/figure-html/unnamed-chunk-4-1.png" width="576"></p>
<p>The two survival curves showed similar trajectories up to six months,
but after that, a difference appeared between the two groups. This is
the so-called delayed difference pattern often seen in immunotherapy
trials. The HR based on the traditional Cox’s method was 0.82 (0.95CI:
0.68 to 0.99, p-value=0.037). Since the validity of the proportional
hazards assumption was not clear in this study, there is no clear
interpretation on the reported HR. Even if the proportional hazards
assumption seemed to be reasonable, the lack of a group-specific
absolute value regarding hazard makes the clinical interpretation of the
treatment effect difficult. For example, if the baseline absolute hazard
is very low, the reported HR (0.82) may indicate a clinically ignorable
treatment effect magnitude. If it is high, even an HR that is closer to
1 (e.g., 0.98) may indicate a clinically significant treatment effect
magnitude.</p>
</div>
<div class="section level2">
<h2 id="average-hazard-with-survival-weight-ahsw">3 Average Hazard with Survival Weight (AHSW)<a class="anchor" aria-label="anchor" href="#average-hazard-with-survival-weight-ahsw"></a>
</h2>
<p>For a given
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi><mo>,</mo></mrow><annotation encoding="application/x-tex">\tau,</annotation></semantics></math>
a general form of the average hazard (AH) is denoted by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>η</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><msubsup><mo>∫</mo><mn>0</mn><mi>τ</mi></msubsup><mi>h</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>w</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>d</mi><mi>u</mi></mrow><mrow><msubsup><mo>∫</mo><mn>0</mn><mi>τ</mi></msubsup><mi>w</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>d</mi><mi>u</mi></mrow></mfrac><mo>,</mo></mrow><annotation encoding="application/x-tex"> \eta(t) = \frac{\int_0^\tau h(u)w(u)du}{\int_0^\tau w(u)du},</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">h(t)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">w(t)</annotation></semantics></math>
are the hazard function for the event time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>,</mo></mrow><annotation encoding="application/x-tex">T,</annotation></semantics></math>
and a non-negative weight function, respectively. Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">S(t)</annotation></semantics></math>
be the survival function for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mi>.</mi></mrow><annotation encoding="application/x-tex">T.</annotation></semantics></math>
We use
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">S(t)</annotation></semantics></math>
as the weight, which gives the AHSW
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>η</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><msubsup><mo>∫</mo><mn>0</mn><mi>τ</mi></msubsup><mi>h</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>d</mi><mi>u</mi></mrow><mrow><msubsup><mo>∫</mo><mn>0</mn><mi>τ</mi></msubsup><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>d</mi><mi>u</mi></mrow></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex"> \eta(t) = \frac{\int_0^\tau h(u)S(u)du}{\int_0^\tau S(u)du}.</annotation></semantics></math>
The detailed motivation for using
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">S(t)</annotation></semantics></math>
as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">w(t)</annotation></semantics></math>
was discussed in Uno and Horiguchi [3]. The AHSW has a clear
interpretation as the average person-time incidence rate on a given time
window
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><mi>τ</mi><mo stretchy="true" form="postfix">]</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">[0,\tau].</annotation></semantics></math>
It can also be called as the general censoring-free incidence rate
(CFIR) in contrast to the conventional person-time incidence rate that
potentially depends on an underlying study-specific censoring time
distribution.</p>
<p>From now on, we simply call the AHSW (or CFIR) the average hazard
(AH). The AH is denoted by the ratio of cumulative incidence probability
and restricted mean survival time at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi><mo>&lt;</mo><mi>∞</mi></mrow><annotation encoding="application/x-tex">\tau &lt; \infty</annotation></semantics></math>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>η</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>τ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mn>1</mn><mo>−</mo><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>τ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msubsup><mo>∫</mo><mn>0</mn><mi>τ</mi></msubsup><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex"> \eta(\tau) = \frac{1-S(\tau)}{\int_0^\tau S(t)dt}.</annotation></semantics></math></p>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>S</mi><mo accent="true">̂</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{S}(t)</annotation></semantics></math>
denote the Kaplan-Meier estimator for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">S(t).</annotation></semantics></math>
A natural estimator for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>η</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>τ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\eta(\tau)</annotation></semantics></math>
is then given by<br><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>η</mi><mo accent="true">̂</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>τ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mn>1</mn><mo>−</mo><mover><mi>S</mi><mo accent="true">̂</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>τ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msubsup><mo>∫</mo><mn>0</mn><mi>τ</mi></msubsup><mover><mi>S</mi><mo accent="true">̂</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex"> \hat{\eta}(\tau) = \frac{1-\hat{S}(\tau)}{\int_0^\tau \hat{S}(t)dt}.</annotation></semantics></math>
The large sample properties and a standard error formula of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>η</mi><mo accent="true">̂</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>τ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{\eta}(\tau)</annotation></semantics></math>
are given in Uno and Horiguchi [3].</p>
</div>
<div class="section level2">
<h2 id="two-sample-comparison-using-ah-and-its-implementation">4 Two-sample comparison using AH and its implementation<a class="anchor" aria-label="anchor" href="#two-sample-comparison-using-ah-and-its-implementation"></a>
</h2>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>η</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>τ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\eta_{1}(\tau)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>η</mi><mn>0</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>τ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\eta_{0}(\tau)</annotation></semantics></math>
denote the AH for treatment group 1 and 0, respectively. Now, we compare
the two survival curves, using the AH. Specifically, we consider the
following two measures to capture the between-group contrast:</p>
<ol style="list-style-type: decimal">
<li>Difference in AH (DAH)
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>η</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>τ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msub><mi>η</mi><mn>0</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>τ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> \eta_{1}(\tau) - \eta_{0}(\tau) </annotation></semantics></math>
</li>
<li>Ratio of AH (RAH)
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>η</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>τ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><msub><mi>η</mi><mn>0</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>τ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> \eta_{1}(\tau) / \eta_{0}(\tau) </annotation></semantics></math>
</li>
</ol>
<p>These are estimated by simply replacing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>η</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>τ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\eta_{1}(\tau)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>η</mi><mn>0</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>τ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\eta_{0}(\tau)</annotation></semantics></math>
by their empirical counterparts (i.e.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><msub><mi>η</mi><mn>1</mn></msub><mo accent="true">̂</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>τ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{\eta_{1}}(\tau)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><msub><mi>η</mi><mn>0</mn></msub><mo accent="true">̂</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>τ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{\eta_{0}}(\tau)</annotation></semantics></math>,
respectively). For the inference of the ratio type metrics, we use the
delta method to calculate the standard error. Specifically, we consider
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mo stretchy="false" form="prefix">{</mo><mover><msub><mi>η</mi><mn>1</mn></msub><mo accent="true">̂</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>τ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\log \{ \hat{\eta_{1}}(\tau)\}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mo stretchy="false" form="prefix">{</mo><mover><msub><mi>η</mi><mn>0</mn></msub><mo accent="true">̂</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>τ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\log \{ \hat{\eta_{0}}(\tau)\}</annotation></semantics></math>
and calculate the standard error of log-AH. We then calculate a
confidence interval for the log-ratio of AH, and transform it back to
the original ratio scale; the detailed formula is given in [4].</p>
<p>The procedures below show how to use the function,
<strong>ah2</strong>, to implement these analyses.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">time</span>   <span class="op">=</span> <span class="va">cm214_pfs</span><span class="op">$</span><span class="va">time</span></span>
<span><span class="va">status</span> <span class="op">=</span> <span class="va">cm214_pfs</span><span class="op">$</span><span class="va">status</span></span>
<span><span class="va">arm</span>    <span class="op">=</span> <span class="va">cm214_pfs</span><span class="op">$</span><span class="va">arm</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ah2.html">ah2</a></span><span class="op">(</span>time<span class="op">=</span><span class="va">time</span>, status<span class="op">=</span><span class="va">status</span>, arm<span class="op">=</span><span class="va">arm</span>, tau<span class="op">=</span><span class="fl">21</span><span class="op">)</span></span></code></pre></div>
<p>The first argument (<strong>time</strong>) is the time-to-event
vector variable. The second argument (<strong>status</strong>) is also a
vector variable with the same length as <strong>time</strong>, each of
the elements takes either 1 (if event) or 0 (if no event). The third
argument (<strong>arm</strong>) is a vector variable to indicate the
assigned treatment of each subject; the elements of this vector take
either 1 (if the active treatment arm) or 0 (if the control arm). The
fourth argument (<strong>tau</strong>) is a scalar value to specify the
truncation time point
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">{\tau}</annotation></semantics></math>
for the AH calculation.</p>
<p>When
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>
is not specified in <strong>ah2</strong>, (i.e., when the code looks
like below)</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ah2.html">ah2</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span>, <span class="va">arm</span><span class="op">)</span></span></code></pre></div>
<p>the default
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>
(i.e., the maximum time point where the size of risk set for both groups
remains at least 10) is used to calculate the AH. It is best to confirm
that the size of the risk set is large enough at the specified
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>
in each group to make sure the Kaplan-Meier estimates are stable.</p>
<p>The <strong>ah2</strong> function returns AH on each group and the
results of the between-group contrast measures listed above. Note that
we chose 21 months for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>
in this example.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obj</span> <span class="op">=</span> <span class="fu"><a href="../reference/ah2.html">ah2</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span>, <span class="va">arm</span>, tau<span class="op">=</span><span class="fl">21</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">obj</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The time window: [eta, tau] = [0, 21] was specified.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of observations: </span></span>
<span><span class="co">#&gt;      Total N Event by tau Censor by tau At risk at tau</span></span>
<span><span class="co">#&gt; arm0     422          225           163             34</span></span>
<span><span class="co">#&gt; arm1     425          219           160             46</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Average Hazard (AH) by arm: </span></span>
<span><span class="co">#&gt;            Est. Lower 0.95 Upper 0.95</span></span>
<span><span class="co">#&gt; AH (arm0) 0.066      0.057      0.076</span></span>
<span><span class="co">#&gt; AH (arm1) 0.049      0.042      0.057</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Between-group contrast: </span></span>
<span><span class="co">#&gt;                                Est. Lower 0.95 Upper 0.95 P-value</span></span>
<span><span class="co">#&gt; Ratio of AH (arm1/arm0)       0.747      0.608      0.917   0.005</span></span>
<span><span class="co">#&gt; Difference of AH (arm1-arm0) -0.017     -0.029     -0.005   0.006</span></span></code></pre></div>
<p>The estimated AHs were 0.049 (0.95CI: 0.042 to 0.057) and 0.066
(0.95CI: 0.057 to 0.076) for the treatment group and the control group,
respectively. The ratio and difference of AH were 0.747 (0.95CI: 0.608
to 0.917, p-value=0.005) and -0.017 (0.95CI: -0.029 to -0.005,
p-value=0.006), respectively.</p>
</div>
<div class="section level2">
<h2 id="conclusions">5 Conclusions<a class="anchor" aria-label="anchor" href="#conclusions"></a>
</h2>
<p>As illustrated, the presented approach using AHSW provides more
robust and reliable quantitative information about the treatment effect
on time-to-event outcomes than the traditional Cox’s hazard ratio
approach. We hope the AHSW-based approach, along with this
<em>survAH</em> package, will be helpful to clinical researchers by
providing interpretable quantitative information about the treatment
effect magnitude, which will ultimately foster better informed decision
making.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>[1] Uno H, Claggett B, Tian L, et al. (2014). Moving beyond the
hazard ratio in quantifying the between-group difference in survival
analysis. <em>Journal of clinical oncology : official journal of the
American Society of Clinical Oncology</em> <strong>32</strong>,
2380-2385. <a href="https://doi.org/10.1200/JCO.2014.55.2208" class="external-link uri">https://doi.org/10.1200/JCO.2014.55.2208</a></p>
<p>[2] Horiguchi M, Hassett MJ, Uno H (2019). How do the accrual pattern
and follow-up duration affect the hazard ratio estimate when the
proportional hazards assumption is violated? <em>Oncologist</em>
<strong>24(7)</strong>, 867-871. <a href="https://doi.org/10.1634/theoncologist.2018-0141" class="external-link uri">https://doi.org/10.1634/theoncologist.2018-0141</a></p>
<p>[3] Uno H and Horiguchi M (2023). Ratio and difference of average
hazard with survival weight: new measures to quantify survival benefit
of new therapy. <em>Statistics in Medicine</em> <strong>Online
first</strong>, 1-17. <a href="https://doi.org/10.1002/sim.9651" class="external-link uri">https://doi.org/10.1002/sim.9651</a></p>
<p>[4] Motzer RJ, Tannir NM, McDermott DF, et al. (2018). Nivolumab plus
ipilimumab versus sunitinib in advanced renal-cell carcinoma. <em>New
England Journal of Medicine</em> <strong>378(14)</strong>, 1277–1290. <a href="https://doi.org/10.1056/NEJMoa1712126" class="external-link uri">https://doi.org/10.1056/NEJMoa1712126</a></p>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://ds.dfci.harvard.edu/~huno/" class="external-link">Hajime Uno</a>, Miki Horiguchi, Zihan Qian.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
